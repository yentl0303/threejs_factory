{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\n// import * as THREE from 'three'\nimport scene from '@/threeModal/scene';\nimport eventBus from '@/utils/eventBus';\nimport gsap from 'gsap';\nimport { CSS3DObject } from 'three/examples/jsm/renderers/CSS3DRenderer';\n// import CameraModule from '@/threeModal/camera'\n// import modityCityMaterial from '../modity/modityCityMaterial'\n// import FlyLine from './flyLine'\n// import FlyLineShader from './flyLineShader'\n// import CreateMeshLine from './createMeshLine'\n// import LineWall from './lineWall'\n// import LineRader from './lineRader'\n// import Alarm from './alarm'\nexport default class CreateCity {\n  constructor() {\n    let daoLoader = new DRACOLoader();\n    let loader = new GLTFLoader();\n    daoLoader.setDecoderPath('/glb/');\n    daoLoader.setDecoderConfig({\n      type: 'js'\n    });\n    daoLoader.preload();\n    loader.setDRACOLoader(daoLoader);\n    // 储存模型\n    this.modelArray = [];\n    this.firstFloor; // 一楼\n    this.secondFloor; // 二楼\n    this.default; // 大楼\n    const objArrName = ['科技展台', '员工办公室', '接待室', '会议室', '设计总监办公室', '总经理办公室'];\n    const obj3dArray = [];\n    loader.load('/glb/工厂一楼.glb', gltf => {\n      gltf.scene.traverse(mesh => {\n        if (mesh.isMesh) {\n          mesh.material.emissiveIntensity = 15;\n        }\n      });\n      gltf.scene.visible = false;\n      this.firstFloor = gltf.scene;\n      this.modelArray.push({\n        name: 'firstFloor',\n        mesh: this.firstFloor\n      });\n      scene.add(gltf.scene);\n    });\n    loader.load('/glb/工厂二楼.glb', gltf => {\n      this.secondFloor = gltf.scene;\n      gltf.scene.traverse(mesh => {\n        if (mesh.isMesh) {\n          mesh.material.emissiveIntensity = 15;\n        }\n        if (objArrName.indexOf(mesh.name) !== -1) {\n          obj3dArray.push(this.cerateTag(mesh));\n        }\n      });\n      gltf.scene.position.setY(30);\n      gltf.scene.visible = true;\n      this.modelArray.push({\n        name: 'secondFloor',\n        mesh: this.secondFloor\n      });\n      console.log(obj3dArray);\n      scene.add(obj3dArray);\n      scene.add(gltf.scene);\n    });\n    // 加载大楼模型\n    loader.load('/glb/工厂大楼.glb', gltf => {\n      // gltf.scene.traverse(mesh => {\n\n      // })\n      gltf.scene.visible = false;\n      this.default = gltf.scene;\n      this.modelArray.push({\n        name: 'default',\n        mesh: this.default\n      });\n      scene.add(gltf.scene);\n    });\n    this.toggleModel();\n  }\n  // 创建标签\n  cerateTag(mesh) {\n    console.log(mesh);\n    const tag = document.createElement('div');\n    tag.className = 'tagDiv';\n    tag.innerHTML = `\n    <div class='objContent'>\n      <h4>${mesh.name}</h4>\n      <p>湿度：86%</p>\n      <p>温度：23℃</p>\n    </div> \n    `;\n    const object3d = new CSS3DObject(tag);\n    object3d.position.copy(mesh.position);\n    return object3d;\n  }\n  // 切换模型\n  toggleModel() {\n    eventBus.on('toggleModel', name => {\n      if (name !== 'hierarchy') {\n        this.default.visible = false;\n        this.firstFloor.visible = false;\n        this.secondFloor.visible = false;\n        if (name === 'firstFloor') {\n          this.firstFloor.position.setY(0);\n          this.firstFloor.visible = true;\n        }\n        if (name === 'secondFloor') {\n          gsap.to(this.secondFloor.position, {\n            y: 30,\n            duration: 1\n          });\n          this.secondFloor.visible = true;\n        }\n        if (name === 'default') {\n          gsap.to(this.default.position, {\n            y: 0,\n            duration: 1\n          });\n          this.default.visible = true;\n        }\n      } else {\n        this.default.visible = true;\n        this.firstFloor.visible = true;\n        this.secondFloor.visible = true;\n        gsap.to(this.default.position, {\n          y: 140,\n          duration: 1\n        });\n        gsap.to(this.secondFloor.position, {\n          y: 70,\n          duration: 1,\n          delay: 1\n        });\n      }\n    });\n  }\n}","map":{"version":3,"names":["DRACOLoader","GLTFLoader","scene","eventBus","gsap","CSS3DObject","CreateCity","constructor","daoLoader","loader","setDecoderPath","setDecoderConfig","type","preload","setDRACOLoader","modelArray","firstFloor","secondFloor","default","objArrName","obj3dArray","load","gltf","traverse","mesh","isMesh","material","emissiveIntensity","visible","push","name","add","indexOf","cerateTag","position","setY","console","log","toggleModel","tag","document","createElement","className","innerHTML","object3d","copy","on","to","y","duration","delay"],"sources":["D:/vscodeDemo/threeDemo/threejs_factory/src/threeModal/mesh/createCity.js"],"sourcesContent":["import { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader'\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\r\n// import * as THREE from 'three'\r\nimport scene from '@/threeModal/scene'\r\nimport eventBus from '@/utils/eventBus'\r\nimport gsap from 'gsap'\r\nimport { CSS3DObject } from 'three/examples/jsm/renderers/CSS3DRenderer'\r\n// import CameraModule from '@/threeModal/camera'\r\n// import modityCityMaterial from '../modity/modityCityMaterial'\r\n// import FlyLine from './flyLine'\r\n// import FlyLineShader from './flyLineShader'\r\n// import CreateMeshLine from './createMeshLine'\r\n// import LineWall from './lineWall'\r\n// import LineRader from './lineRader'\r\n// import Alarm from './alarm'\r\nexport default class CreateCity {\r\n  constructor () {\r\n    let daoLoader = new DRACOLoader()\r\n    let loader = new GLTFLoader()\r\n    daoLoader.setDecoderPath('/glb/')\r\n    daoLoader.setDecoderConfig({ type: 'js' })\r\n    daoLoader.preload()\r\n    loader.setDRACOLoader(daoLoader)\r\n    // 储存模型\r\n    this.modelArray = []\r\n    this.firstFloor // 一楼\r\n    this.secondFloor // 二楼\r\n    this.default // 大楼\r\n    const objArrName = ['科技展台', '员工办公室', '接待室', '会议室', '设计总监办公室', '总经理办公室']\r\n    const obj3dArray = []\r\n    loader.load('/glb/工厂一楼.glb', gltf => {\r\n      gltf.scene.traverse(mesh => {\r\n        if (mesh.isMesh) {\r\n          mesh.material.emissiveIntensity = 15\r\n        }\r\n      })\r\n      gltf.scene.visible = false\r\n      this.firstFloor = gltf.scene\r\n      this.modelArray.push({ name: 'firstFloor', mesh: this.firstFloor })\r\n      scene.add(gltf.scene)\r\n    })\r\n    loader.load('/glb/工厂二楼.glb', gltf => {\r\n      this.secondFloor = gltf.scene\r\n      gltf.scene.traverse(mesh => {\r\n        if (mesh.isMesh) {\r\n          mesh.material.emissiveIntensity = 15\r\n        }\r\n        if (objArrName.indexOf(mesh.name) !== -1) {\r\n          obj3dArray.push(this.cerateTag(mesh))\r\n        }\r\n      })\r\n\r\n      gltf.scene.position.setY(30)\r\n      gltf.scene.visible = true\r\n      this.modelArray.push({ name: 'secondFloor', mesh: this.secondFloor })\r\n      console.log(obj3dArray);\r\n      scene.add(obj3dArray)\r\n      scene.add(gltf.scene)\r\n    })\r\n    // 加载大楼模型\r\n    loader.load('/glb/工厂大楼.glb', gltf => {\r\n      // gltf.scene.traverse(mesh => {\r\n\r\n      // })\r\n      gltf.scene.visible = false\r\n      this.default = gltf.scene\r\n      this.modelArray.push({ name: 'default', mesh: this.default })\r\n      scene.add(gltf.scene)\r\n    })\r\n    \r\n    this.toggleModel()\r\n  }\r\n  // 创建标签\r\n  cerateTag(mesh) {\r\n    console.log(mesh);\r\n    const tag = document.createElement('div')\r\n    tag.className = 'tagDiv'\r\n    tag.innerHTML = `\r\n    <div class='objContent'>\r\n      <h4>${mesh.name}</h4>\r\n      <p>湿度：86%</p>\r\n      <p>温度：23℃</p>\r\n    </div> \r\n    `\r\n    const object3d = new CSS3DObject(tag)\r\n    object3d.position.copy(mesh.position)\r\n    return object3d\r\n  }\r\n  // 切换模型\r\n  toggleModel () {\r\n    eventBus.on('toggleModel', name => {\r\n      if (name  !== 'hierarchy') {\r\n        this.default.visible = false\r\n        this.firstFloor.visible = false\r\n        this.secondFloor.visible = false\r\n        if(name === 'firstFloor') {\r\n          this.firstFloor.position.setY(0)\r\n          this.firstFloor.visible = true\r\n        }\r\n        if(name === 'secondFloor'){\r\n          gsap.to(this.secondFloor.position, {\r\n            y: 30,\r\n            duration: 1,\r\n          })\r\n          this.secondFloor.visible = true\r\n        }\r\n        if (name === 'default') {\r\n          gsap.to(this.default.position, {\r\n            y: 0,\r\n            duration: 1,\r\n          })\r\n          this.default.visible = true\r\n        }\r\n      } else {\r\n        this.default.visible = true\r\n        this.firstFloor.visible = true\r\n        this.secondFloor.visible = true\r\n        gsap.to(this.default.position, {\r\n          y: 140,\r\n          duration: 1,\r\n        })\r\n        gsap.to(this.secondFloor.position, {\r\n          y: 70,\r\n          duration: 1,\r\n          delay: 1\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}