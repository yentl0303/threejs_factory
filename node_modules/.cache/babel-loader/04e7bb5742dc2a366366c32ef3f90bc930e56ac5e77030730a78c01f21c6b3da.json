{"ast":null,"code":"import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport * as THREE from 'three';\nimport scene from '@/threeModal/scene';\nimport modityCityMaterial from '../modity/modityCityMaterial';\n// import FlyLine from './flyLine'\nimport FlyLineShader from './flyLineShader';\nimport CreateMeshLine from './createMeshLine';\nimport LineWall from './lineWall';\nimport LineRader from './lineRader';\nimport Alarm from './alarm';\nexport default function createCity() {\n  const loader = new GLTFLoader();\n  // 加载城市模型\n  loader.load('./modal/city.glb', gltf => {\n    gltf.scene.traverse(item => {\n      if (item.type === 'Mesh') {\n        // 设置城市材质\n        const cityMaterial = new THREE.MeshBasicMaterial({\n          color: new THREE.Color('#551A8B')\n        });\n        item.material = cityMaterial;\n        // 当只有模型是城市的时候才需要加上线框\n        if (item.name === \"Layerbuildings\") {\n          const meshLine = new CreateMeshLine(item.geometry);\n          // 线框和城市模型不一致，将城市模型数据给到线框\n          meshLine.mesh.scale.set(item.scale.x, item.scale.y, item.scale.z);\n          meshLine.mesh.position.set(item.position.x, item.position.y, item.position.z);\n          scene.add(meshLine.mesh);\n        }\n        // 修改城市材质\n        modityCityMaterial(item);\n      }\n    });\n    scene.add(gltf.scene);\n  });\n\n  // 添加飞线\n  // const flyLine = new FlyLine()\n  // scene.add(flyLine.mesh)\n\n  const flyLineShader = new FlyLineShader();\n  scene.add(flyLineShader.mesh);\n\n  // 添加光墙\n  const lineWall = new LineWall();\n  scene.add(lineWall.mesh);\n\n  // 添加雷达\n  const lineRader = new LineRader();\n  scene.add(lineRader.mesh);\n\n  // 添加警告标识\n  const alarm = new Alarm();\n  scene.add(alarm.mesh);\n  alarm.onClick(() => {\n    alert('警告');\n  });\n}","map":{"version":3,"names":["GLTFLoader","THREE","scene","modityCityMaterial","FlyLineShader","CreateMeshLine","LineWall","LineRader","Alarm","createCity","loader","load","gltf","traverse","item","type","cityMaterial","MeshBasicMaterial","color","Color","material","name","meshLine","geometry","mesh","scale","set","x","y","z","position","add","flyLineShader","lineWall","lineRader","alarm","onClick","alert"],"sources":["D:/vscodeDemo/threeDemo/threejs_smartcity/src/threeModal/mesh/createCity.js"],"sourcesContent":["import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\r\nimport * as THREE from 'three'\r\nimport scene from '@/threeModal/scene'\r\nimport modityCityMaterial from '../modity/modityCityMaterial'\r\n// import FlyLine from './flyLine'\r\nimport FlyLineShader from './flyLineShader'\r\nimport CreateMeshLine from './createMeshLine'\r\nimport LineWall from './lineWall'\r\nimport LineRader from './lineRader'\r\nimport Alarm from './alarm'\r\nexport default function createCity() {\r\n  const loader = new GLTFLoader()\r\n  // 加载城市模型\r\n  loader.load('./modal/city.glb', gltf => {\r\n    gltf.scene.traverse(item => {\r\n      if(item.type === 'Mesh') {\r\n        // 设置城市材质\r\n        const cityMaterial =  new THREE.MeshBasicMaterial({color: new THREE.Color('#551A8B')})\r\n        item.material = cityMaterial\r\n        // 当只有模型是城市的时候才需要加上线框\r\n        if(item.name === \"Layerbuildings\"){\r\n          const meshLine = new CreateMeshLine(item.geometry)\r\n          // 线框和城市模型不一致，将城市模型数据给到线框\r\n          meshLine.mesh.scale.set(item.scale.x, item.scale.y, item.scale.z)\r\n          meshLine.mesh.position.set(item.position.x, item.position.y , item.position.z)\r\n          scene.add(meshLine.mesh)\r\n        }\r\n        // 修改城市材质\r\n        modityCityMaterial(item)\r\n      }\r\n    })\r\n    scene.add(gltf.scene)\r\n  })\r\n\r\n  // 添加飞线\r\n  // const flyLine = new FlyLine()\r\n  // scene.add(flyLine.mesh)\r\n\r\n  const flyLineShader = new FlyLineShader()\r\n  scene.add(flyLineShader.mesh)\r\n\r\n  // 添加光墙\r\n  const lineWall = new LineWall()\r\n  scene.add(lineWall.mesh) \r\n\r\n  // 添加雷达\r\n  const lineRader = new LineRader()\r\n  scene.add(lineRader.mesh)\r\n\r\n  // 添加警告标识\r\n  const alarm = new Alarm()\r\n  scene.add(alarm.mesh)\r\n  alarm.onClick(() => {\r\n    alert('警告')\r\n  })\r\n}"],"mappings":"AAAA,SAASA,UAAU,QAAQ,uCAAuC;AAClE,OAAO,KAAKC,KAAK,MAAM,OAAO;AAC9B,OAAOC,KAAK,MAAM,oBAAoB;AACtC,OAAOC,kBAAkB,MAAM,8BAA8B;AAC7D;AACA,OAAOC,aAAa,MAAM,iBAAiB;AAC3C,OAAOC,cAAc,MAAM,kBAAkB;AAC7C,OAAOC,QAAQ,MAAM,YAAY;AACjC,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAOC,KAAK,MAAM,SAAS;AAC3B,eAAe,SAASC,UAAU,GAAG;EACnC,MAAMC,MAAM,GAAG,IAAIV,UAAU,EAAE;EAC/B;EACAU,MAAM,CAACC,IAAI,CAAC,kBAAkB,EAAEC,IAAI,IAAI;IACtCA,IAAI,CAACV,KAAK,CAACW,QAAQ,CAACC,IAAI,IAAI;MAC1B,IAAGA,IAAI,CAACC,IAAI,KAAK,MAAM,EAAE;QACvB;QACA,MAAMC,YAAY,GAAI,IAAIf,KAAK,CAACgB,iBAAiB,CAAC;UAACC,KAAK,EAAE,IAAIjB,KAAK,CAACkB,KAAK,CAAC,SAAS;QAAC,CAAC,CAAC;QACtFL,IAAI,CAACM,QAAQ,GAAGJ,YAAY;QAC5B;QACA,IAAGF,IAAI,CAACO,IAAI,KAAK,gBAAgB,EAAC;UAChC,MAAMC,QAAQ,GAAG,IAAIjB,cAAc,CAACS,IAAI,CAACS,QAAQ,CAAC;UAClD;UACAD,QAAQ,CAACE,IAAI,CAACC,KAAK,CAACC,GAAG,CAACZ,IAAI,CAACW,KAAK,CAACE,CAAC,EAAEb,IAAI,CAACW,KAAK,CAACG,CAAC,EAAEd,IAAI,CAACW,KAAK,CAACI,CAAC,CAAC;UACjEP,QAAQ,CAACE,IAAI,CAACM,QAAQ,CAACJ,GAAG,CAACZ,IAAI,CAACgB,QAAQ,CAACH,CAAC,EAAEb,IAAI,CAACgB,QAAQ,CAACF,CAAC,EAAGd,IAAI,CAACgB,QAAQ,CAACD,CAAC,CAAC;UAC9E3B,KAAK,CAAC6B,GAAG,CAACT,QAAQ,CAACE,IAAI,CAAC;QAC1B;QACA;QACArB,kBAAkB,CAACW,IAAI,CAAC;MAC1B;IACF,CAAC,CAAC;IACFZ,KAAK,CAAC6B,GAAG,CAACnB,IAAI,CAACV,KAAK,CAAC;EACvB,CAAC,CAAC;;EAEF;EACA;EACA;;EAEA,MAAM8B,aAAa,GAAG,IAAI5B,aAAa,EAAE;EACzCF,KAAK,CAAC6B,GAAG,CAACC,aAAa,CAACR,IAAI,CAAC;;EAE7B;EACA,MAAMS,QAAQ,GAAG,IAAI3B,QAAQ,EAAE;EAC/BJ,KAAK,CAAC6B,GAAG,CAACE,QAAQ,CAACT,IAAI,CAAC;;EAExB;EACA,MAAMU,SAAS,GAAG,IAAI3B,SAAS,EAAE;EACjCL,KAAK,CAAC6B,GAAG,CAACG,SAAS,CAACV,IAAI,CAAC;;EAEzB;EACA,MAAMW,KAAK,GAAG,IAAI3B,KAAK,EAAE;EACzBN,KAAK,CAAC6B,GAAG,CAACI,KAAK,CAACX,IAAI,CAAC;EACrBW,KAAK,CAACC,OAAO,CAAC,MAAM;IAClBC,KAAK,CAAC,IAAI,CAAC;EACb,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}