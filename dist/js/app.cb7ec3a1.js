(function(){var e={2731:function(e,o,t){"use strict";var n=t(9242),i=t(3396),s=t(4870),r=t(1114),l=t(2236);const a=new r.xsS,c=new l.x;c.loadAsync("./texture/nocturne.hdr").then((e=>{a.background=e,a.environment=e,a.environment.mapping=r.dSO}));const d=new r.Ox3(16777215,1);d.position.set(10,100,50),a.add(d);var u=a,h=t(1373);const f=new h.Z;var v=f;const m=new r.cPb(75,window.innerWidth/window.innerHeight,.1,1e3);m.position.set(0,100,350);class p{constructor(){this.activeCamera=m,this.collection={default:m},v.on("toggleCameraEvent",(e=>{this.setCamera(e)}))}addCamera(e,o){this.collection[e]=o}setCamera(e){this.activeCamera=this.collection[e]}}var y=new p,g=t(2519);const w=new r.b5g({antialias:!0});w.shadowMap.enabled=!0,w.toneMapping=r.LY2,w.toneMappingExposure=1.5,w.setSize(window.innerWidth,window.innerHeight);const _=new g.lX;_.setSize(window.innerWidth,window.innerHeight),document.querySelector("#object3d").appendChild(_.domElement);var F={renderer:w,css3dRender:_},b=(t(7658),t(3767),t(8585),t(8696),t(1989)),P=t(9469),C=t(8552),M=t(553),x=t.n(M),T=t(3672),k=t.n(T),A=t(530),N=t.n(A);class j{constructor(){let e=new b._,o=new P.E;e.setDecoderPath("/glb/"),e.setDecoderConfig({type:"js"}),e.preload(),o.setDRACOLoader(e),this.modelArray=[],this.firstFloor,this.secondFloor,this.default,this.flyModel;const t=["科技展台","员工办公室","接待室","会议室","设计总监办公室","总经理办公室"];this.obj3dArray=[],o.load("/glb/工厂一楼.glb",(e=>{this.firstFloor=e.scene,this.firstFloor.traverse((e=>{e.isMesh&&(e.material.emissiveIntensity=15)})),this.firstFloorTrue(),this.modelArray.push({name:"firstFloor",mesh:this.firstFloor}),u.add(this.firstFloor)})),o.load("/glb/工厂二楼.glb",(e=>{this.secondFloor=e.scene,this.secondFloor.traverse((e=>{if(e.isMesh&&(e.material.emissiveIntensity=15),-1!==t.indexOf(e.name)){const o=this.cerateTag(e);this.secondFloor.add(o),this.obj3dArray.push(o)}})),this.secondFloor.position.setY(30),this.secondFloorTrue(),this.modelArray.push({name:"secondFloor",mesh:this.secondFloor}),u.add(this.secondFloor),this.obj3dArray.forEach((e=>e.visible=!1)),o.load("/glb/fly.glb",(e=>{this.flyModel=e.scene.children[0],this.flyModel.scale.set(.2,.2,.2),this.flyModel.position.set(18,35,43),this.flyModel.traverse((e=>{e.position2=e.position.clone()})),u.add(this.flyModel),this.clickFly()})),N().done()})),o.load("/glb/工厂大楼.glb",(e=>{this.default=e.scene,this.defaultTrue(),this.modelArray.push({name:"default",mesh:this.default}),u.add(this.default)})),this.init()}clickFly(){const e=new r.iMs,o=new r.FM8;window.addEventListener("click",(t=>{const n=t;o.x=n.clientX/window.innerWidth*2-1,o.y=-(n.clientY/window.innerHeight*2-1),e.setFromCamera(o,y.activeCamera),console.log(this.flyModel);let i=e.intersectObject(this.flyModel);console.log(i),i.length>0&&this.allNone()}))}cerateTag(e){const o=document.createElement("div");o.className="tagDiv",o.innerHTML=`\n    <div class='objContent'>\n      <h4>${e.name}</h4>\n      <p>湿度：86%</p>\n      <p>温度：23℃</p>\n    </div> \n    `;const t=new g.cp(o);return t.position.copy(e.position),t.scale.set(.2,.2,.2),t}flyNone(){this.flyModel.visible=!1}flyTrue(){this.flyModel.visible=!0}firstFloorNone(){this.firstFloor.visible=!1}secondFloorNone(){this.secondFloor.visible=!1,this.obj3dArray.forEach((e=>e.visible=!1))}defaultNone(){this.default.visible=!1}firstFloorTrue(){this.firstFloor.visible=!0}secondFloorTrue(){this.secondFloor.visible=!0,this.obj3dArray.forEach((e=>e.visible=!0))}defaultTrue(){this.default.visible=!0}allTrue(){this.firstFloorTrue(),this.secondFloorTrue(),this.defaultTrue()}allNone(){this.firstFloorNone(),this.secondFloorNone(),this.defaultNone()}initFloor(){this.secondFloor.position.setY(30),this.flyModel.position.setY(35),this.firstFloor.position.setY(0),this.default.position.setY(0)}init(){v.on("showDefault",(()=>{this.initFloor(),this.allNone(),this.flyNone(),this.defaultTrue()})),v.on("showFirstFloor",(()=>{this.initFloor(),this.allNone(),this.flyNone(),this.firstFloor.position.setY(0),this.firstFloorTrue()})),v.on("showSecondFloor",(()=>{this.initFloor(),this.allNone(),this.flyNone(),this.secondFloor.position.setY(30),this.flyModel.position.setY(35),this.secondFloorTrue(),this.flyTrue()})),v.on("snFloorTrue",(()=>{this.allTrue(),this.flyTrue(),C.ZP.to(this.default.position,{y:140,duration:1}),C.ZP.to(this.flyModel.position,{y:75,duration:1,delay:1}),C.ZP.to(this.secondFloor.position,{y:70,duration:1,delay:1})})),v.on("snFloorNone",(()=>{C.ZP.to(this.default.position,{y:0,duration:1,delay:1,onComplete:()=>{this.flyNone(),this.secondFloorNone()}}),C.ZP.to(this.flyModel.position,{y:35,duration:1}),C.ZP.to(this.secondFloor.position,{y:30,duration:1})}));let e=[];v.on("toggleFly",(()=>{if(e.length>0)return;this.allNone(),this.flyTrue(),this.flyModel.position.setY(35);for(let t=0;t<4;t++)for(let o=0;o<4;o++)e.push(new r.Pa4(2*t-2,2*o-2,0));let o=0;console.log(this.flyModel),this.flyModel.traverse((t=>{e[o].multiplyScalar(10),C.ZP.to(t.position,{x:"+="+e[o].x,y:"+="+e[o].y,z:"+="+e[o].z,duration:1}),o++}))})),v.on("recoverFly",(()=>{e=[],this.flyModel.traverse((e=>{C.ZP.to(e.position,{x:e.position2.x,y:e.position2.y,z:e.position2.z,duration:1})}))})),v.on("flyPoint",(()=>{this.ceratePoint(this.flyModel)})),v.on("flyBoob",(()=>{this.boob()})),v.on("pointRecver",(()=>{this.back()}))}back(){this.flyPontGroup&&this.flyPontGroup.traverse((e=>{e.isPoints&&C.ZP.to(e.material.uniforms.uTime,{value:0,duration:3})}))}boob(){this.flyPontGroup&&this.flyPontGroup.traverse((e=>{if(e.isPoints){let o=new Float32Array(3*e.geometry.attributes.position.count);for(let t=0;t<e.geometry.attributes.position.count;t++)o[3*t+0]=10*(2*Math.random()-1),o[3*t+1]=10*(2*Math.random()-1),o[3*t+2]=10*(2*Math.random()-1);e.geometry.setAttribute("aPosition",new r.TlE(o,3)),C.ZP.to(e.material.uniforms.uTime,{value:10,duration:3})}}))}ceratePoint(e){this.flyPontGroup?(u.remove(this.flyPontGroup),this.flyPontGroup=null):(this.flyPontGroup=this.transforms(e),u.add(this.flyPontGroup))}transforms(e){const o=new r.dpR,t=o.load("./particles/3.png"),n=new r.ZAu;function i(e,o){e.children.length>0&&e.children.forEach((e=>{console.log(e);const n=new r.Ilk(Math.random(),Math.random(),Math.random()),s=new r.jyz({uniforms:{uColor:{value:n},uTexture:{value:t},uTime:{value:0}},vertexShader:k(),fragmentShader:x(),depthWrite:!0,transparent:!0,depthTest:!1}),l=new r.woe(e.geometry,s);l.position.copy(e.position),o.add(l),i(e,l)}))}return i(e,n),n}}function S(){new j}var E=t(4543),O=t(1183),D=t(1984);class z{constructor(){this.setOrbitControls(),v.on("toggleControls",(e=>{console.log(`set${e}Controls`),this[`set${e}Controls`]()}))}setOrbitControls(){this.controls=new E.z(y.activeCamera,F.renderer.domElement),this.controls.enableDamping=!0,this.controls.maxPolarAngle=Math.PI/2,this.controls.minPolarAngle=0}setFlyControls(){this.controls=new O.m(y.activeCamera,F.renderer.domElement),this.controls.maxPolarAngle=Math.PI/2,this.controls.minPolarAngle=0}setFirstPersonControls(){this.controls=new D.o(y.activeCamera,F.renderer.domElement),this.controls.maxPolarAngle=Math.PI/2,this.controls.minPolarAngle=0}}var Z=new z;const Y=new r.SUY;function W(){const e=Y.getDelta();Z.controls.update(e),F.renderer.render(u,y.activeCamera),F.css3dRender.render(u,y.activeCamera),requestAnimationFrame(W)}window.addEventListener("resize",(()=>{y.activeCamera.aspect=window.innerWidth/window.innerHeight,y.activeCamera.updateProjectionMatrix(),F.renderer.setSize(window.innerWidth,window.innerHeight),F.renderer.setPixelRatio(window.devicePixelRatio),F.css3dRender.setSize(window.innerWidth,window.innerHeight)}));var H={__name:"SceneCanvas",setup(e){let o=(0,s.iH)(null);return u.add(y.activeCamera),S(),(0,i.bv)((()=>{o.value.appendChild(F.renderer.domElement),W()})),(e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"sceneCanvas",ref_key:"sceneDiv",ref:o},null,512))}},G=t(89);const R=(0,G.Z)(H,[["__scopeId","data-v-33ccad97"]]);var I=R,L=t.p+"img/bar.f0210aef.svg";const B=e=>((0,i.dD)("data-v-15d0e5ec"),e=e(),(0,i.Cn)(),e),$={id:"bigScreen"},q=B((()=>(0,i._)("div",{class:"header"},"智慧工厂",-1))),U={class:"mian"},X={class:"left"},V={class:"cityEvent"},J=B((()=>(0,i._)("h3",null,[(0,i._)("span",null,"切换视图模型")],-1))),K=B((()=>(0,i._)("img",{src:L,class:"svg"},null,-1))),Q=B((()=>(0,i._)("span",null,"工厂大楼",-1))),ee=[K,Q],oe=B((()=>(0,i._)("img",{src:L,class:"svg"},null,-1))),te=B((()=>(0,i._)("span",null,"工厂一楼",-1))),ne=[oe,te],ie=B((()=>(0,i._)("img",{src:L,class:"svg"},null,-1))),se=B((()=>(0,i._)("span",null,"工厂二楼",-1))),re=[ie,se],le=B((()=>(0,i._)("img",{src:L,class:"svg"},null,-1))),ae=B((()=>(0,i._)("span",null,"工厂整体",-1))),ce=[le,ae],de=B((()=>(0,i._)("div",{class:"footerBoder"},null,-1))),ue={class:"right"},he={class:"cityEvent"},fe=B((()=>(0,i._)("h3",null,"无人机模型",-1))),ve=B((()=>(0,i._)("h1",null,[(0,i._)("div",null,[(0,i._)("img",{src:L,class:"svg"}),(0,i._)("span",null,"无人机零件展开")])],-1))),me=[ve],pe=B((()=>(0,i._)("h1",null,[(0,i._)("div",null,[(0,i._)("img",{src:L,class:"svg"}),(0,i._)("span",null,"无人机复原")])],-1))),ye=[pe],ge=B((()=>(0,i._)("h1",null,[(0,i._)("div",null,[(0,i._)("img",{src:L,class:"svg"}),(0,i._)("span",null,"无人机粒子特效")])],-1))),we=[ge],_e=B((()=>(0,i._)("h1",null,[(0,i._)("div",null,[(0,i._)("img",{src:L,class:"svg"}),(0,i._)("span",null,"无人机粒子爆炸")])],-1))),Fe=[_e],be=B((()=>(0,i._)("h1",null,[(0,i._)("div",null,[(0,i._)("img",{src:L,class:"svg"}),(0,i._)("span",null,"无人机粒子复原")])],-1))),Pe=[be],Ce=B((()=>(0,i._)("div",{class:"footerBoder"},null,-1)));var Me={__name:"bigScreen",setup(e){let o=!1;const t=()=>{o=!1,v.emit("showDefault")},n=()=>{o=!1,v.emit("showFirstFloor")},s=()=>{o=!1,v.emit("showSecondFloor")},r=()=>{o=!o,o?v.emit("snFloorTrue"):v.emit("snFloorNone")},l=()=>{v.emit("toggleFly")},a=()=>{v.emit("recoverFly")},c=()=>{v.emit("flyPoint")},d=()=>{v.emit("flyBoob")},u=()=>{v.emit("pointRecver")};return(e,o)=>((0,i.wg)(),(0,i.iD)("div",$,[q,(0,i._)("div",U,[(0,i._)("div",X,[(0,i._)("div",V,[J,(0,i._)("h1",{onClick:o[0]||(o[0]=e=>t())},ee),(0,i._)("h1",{onClick:o[1]||(o[1]=e=>n())},ne),(0,i._)("h1",{onClick:o[2]||(o[2]=e=>s())},re),(0,i._)("h1",{onClick:o[3]||(o[3]=e=>r())},ce),de])]),(0,i._)("div",ue,[(0,i._)("div",he,[fe,(0,i._)("ul",null,[(0,i._)("li",{onClick:o[4]||(o[4]=e=>l())},me),(0,i._)("li",{onClick:o[5]||(o[5]=e=>a())},ye),(0,i._)("li",{onClick:o[6]||(o[6]=e=>c())},we),(0,i._)("li",{onClick:o[7]||(o[7]=e=>d())},Fe),(0,i._)("li",{onClick:o[8]||(o[8]=e=>u())},Pe)]),Ce])])])]))}};const xe=(0,G.Z)(Me,[["__scopeId","data-v-15d0e5ec"]]);var Te=xe,ke={__name:"HomeView",setup(e){return(e,o)=>((0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(I),(0,i.Wm)(Te)]))}};const Ae=ke;var Ne=Ae,je={__name:"App",setup(e){return(0,i.wF)((()=>{N().start()})),(e,o)=>((0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)((0,s.SU)(Ne))]))}};const Se=je;var Ee=Se;N().configure({easing:"ease",speed:500,showSpinner:!1,trickleSpeed:200,minimum:.6}),(0,n.ri)(Ee).mount("#app")},553:function(e){e.exports="uniform sampler2D uTexture;\r\nuniform vec3 uColor;\r\nvoid main() {\r\n    vec4 uTextrueColor = texture2D(uTexture, gl_PointCoord);\r\n    gl_FragColor = vec4(uColor, uTextrueColor.x);\r\n}"},3672:function(e){e.exports="attribute vec3 aPosition;\r\nuniform float uTime;\r\nvoid main() {\r\n  // position = 视图矩阵 * 模型矩阵 * position\r\n  vec4 currentPosition = modelMatrix * vec4(position, 1.0);\r\n  // 当前点到随机出来的点距离\r\n  vec3 direction = aPosition - currentPosition.xyz;\r\n  vec3 targetPosition = currentPosition.xyz + direction * uTime;\r\n  vec4 viewPosition = viewMatrix * vec4(targetPosition, 1.0);\r\n  // 设置position = 项目矩阵 * 视图位置\r\n  gl_Position = projectionMatrix * viewPosition;\r\n  // 远离摄象机细，靠近粗\r\n  gl_PointSize = -100.0 / viewPosition.z;\r\n}"}},o={};function t(n){var i=o[n];if(void 0!==i)return i.exports;var s=o[n]={exports:{}};return e[n].call(s.exports,s,s.exports,t),s.exports}t.m=e,function(){var e=[];t.O=function(o,n,i,s){if(!n){var r=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],s=e[d][2];for(var l=!0,a=0;a<n.length;a++)(!1&s||r>=s)&&Object.keys(t.O).every((function(e){return t.O[e](n[a])}))?n.splice(a--,1):(l=!1,s<r&&(r=s));if(l){e.splice(d--,1);var c=i();void 0!==c&&(o=c)}}return o}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,i,s]}}(),function(){t.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(o,{a:o}),o}}(),function(){t.d=function(e,o){for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){t.p="/"}(),function(){var e={143:0};t.O.j=function(o){return 0===e[o]};var o=function(o,n){var i,s,r=n[0],l=n[1],a=n[2],c=0;if(r.some((function(o){return 0!==e[o]}))){for(i in l)t.o(l,i)&&(t.m[i]=l[i]);if(a)var d=a(t)}for(o&&o(n);c<r.length;c++)s=r[c],t.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return t.O(d)},n=self["webpackChunkthreejs_factory"]=self["webpackChunkthreejs_factory"]||[];n.forEach(o.bind(null,0)),n.push=o.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(2731)}));n=t.O(n)})();
//# sourceMappingURL=app.cb7ec3a1.js.map